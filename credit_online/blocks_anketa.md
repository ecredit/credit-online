# Логика работы Кредит Онлайн

## Конекст
Страница Кредит Онлайн всегда работает в контексте какого-то конкретного дилерского центра. Например, список автомобилей загружается именно для конкретного ДЦ, кредитные предложения выдаются именно по подключенным к данному ДЦ банкам и прочее.

По умолчанию берется так называемый "дефолтный дилерский центр" - это дилерский центр по умолчанию назначенный для сайта Кредит Онлайн у каждого партнера.

Но можно принудетльно изменить контекст работы страницы Кредит Онлайн. Для этого в строке параметров необходимо указать dealer_id по нумерации еКредит. При этом данный dealer_id должен быть привязан к настройкам текущего сайта.

## Блок меню F&I Hub
Блок представляет собой главное меню сайта, которое содержит ссылки на все подключенные к данному сайту сервисы.


## Блок калькулятора
Блок калькулятора состоит из следующих элементов:
1. Селекты выбора автомобиля
1. Поле стоимости автомобиля, поле ввода первоначального взноса и слайдер первоначального взноса
1. Список кредитных расчетов

В селектах отображается набор автомобилей, который используется внутри системы еКредит для дилера из текущего контекста.

Список новых автомобилей в системе еКредит может задаваться или настройками Карфина, либо дилер может загружать свой собственный каталог автомобилей.

Набор пробежных автомобилей для всех дилеров внутри еКредита используется один и тот же.

## Блок выбора дилера
1. Отображаются дилеры, которые привязаны к дилерской группе данного текущего токена
1. Список дилеров становится доступен только после выбора кредитного расчета. В этот момент из всего доступного списка дилеров остаются только те, которые торгуют брендом, выбранного автомобиля

## Входящие параметры
Кредит Онлайн не требует обязательных параметров. Страница партнера настраивает контекст дефолтного дилера автоматически и сразу готова к работе. Но параметры работы страницы можно изменить, передав соответствующие параметры

Параметры *brand, model, configuration* используются для определения в селектах автомобиля данных *Марка, Модель, Комплектация*.

Параметры *brand, model* всегда должны в точности соотствовать справочникам в еКредите.

Так же нужно учитывать, контекст работы страницы. Переданный автомобиль может быть распознан в селектах только в том случае, если он уже в них загружен. А за загруженный список автомобилей в селектах отвечает текущий контекст работы Кредит Онлайна. По умолчанию в конекст ставится дефолтный дилер, привязанный к вашей среде. И если в дефолтном дилера такого автомобиля нет, то необходимо установить контекст с нужным дилеров, передав в параметрах запроса dealer_id по нумерации еКредит.

